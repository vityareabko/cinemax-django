
{% extends "base.html" %}
{% load static i18n %}
{% block title %}Зал{% endblock %}

{% block stylesheet %} 

    <link rel="stylesheet" href="{% static 'css/reservations.css' %}">
    
{% endblock %}

{% block content %}
            <table class="body-wrap  ">
                <tbody>
                    <tr>
                        <td></td>
                        <td class="container" width="600">
                            <div class="content shadow">
                                <table class="main" width="100%" cellpadding="0" cellspacing="0">
                                    <tbody>
                                        <tr>
                                            <td class="content-wrap  aligncenter">
                                                <table width="100%" cellpadding="0" cellspacing="0">
                                                    <tbody>
                                                        <tr>
                                                            <td class="content-block">
                                                                <h1>Cinemax</h1>
                                                            </td>
                                                        </tr>
                                                        <tr>
                                                            <td class="content-block">
                                                                <table class="invoice">
                                                                    <tbody>
                                                                        <tr>
                                                                            <td>
                                                                                <table class="invoice-items" cellpadding="0" cellspacing="0">
                                                                                    <tbody>
                                                                                        <tr>
                                                                                            <td class="text-right pr-2">{% trans "Фільм" %}: </td>
                                                                                            <td class=""> {{ movie.name }} </td>
                                                                                        </tr>
                                                                                        <tr>
                                                                                            <td class="text-right pr-2">{% trans "Дата показу" %}: </td>
                                                                                            <td class=""> {{ session.session_date }}  </td>
                                                                                        </tr>
                                                                                        <tr>
                                                                                            <td class="text-right pr-2">{% trans "Час сеансу" %}: </td>
                                                                                            <td class=""> {{ time_sessions.time }}  </td>
                                                                                        </tr>
                                                                                        <tr>
                                                                                            <td class="text-right pr-2">{% trans "зал" %} №: </td>
                                                                                            <td class=""> {{ num_hall }} </td>
                                                                                        </tr>
                                                                                        <tr>
                                                                                            <td class="text-right pr-2">{% trans "Ряд" %}: </td>
                                                                                            <td class=""> {{ place.row_number }}  </td>
                                                                                        </tr>
                                                                                        <tr>
                                                                                            <td class="text-right pr-2">{% trans "Місце в залі" %}: </td>
                                                                                            <td class=""> {{ place.place_number }}  </td>
                                                                                        </tr>
                                                                                        <tr>
                                                                                            <td class="text-right pr-2">{% trans "Ціна сеансу" %}: </td>
                                                                                            <td class=""> {{ session.price_session }} ₴  </td>
                                                                                        </tr>
                                                                                        <tr>
                                                                                            <td class="text-right pr-2">{% trans "Ціна за сектор" %}: </td>
                                                                                            <td class=""> {{ sector.price_sector }} ₴ </td>
                                                                                        </tr>
                                                                                        <tr>
                                                                                            
                                                                                            <!-- <img src="{{ test }}" alt=""> -->
                                                                                           
                                                                                        </tr>
                                                                                        
                                                                                    </tbody>
                                                                                </table>
                                                                            </td>
                                                                        </tr>
                                                                        <tr>
                                                                            <td>
                                                                                <table class="invoice-items" cellpadding="0" cellspacing="0">
                                                                                    <tbody>
                                                                                        
                                                                                        <tr>
                                                                                            <td>{% trans "Кінцева ціна" %}</td>
                                                                                            <td class="alignright"> </td>
                                                                                        </tr>
                                                                                        <tr class="total">
                                                                                            <td class="alignright" width="80%">{% trans "В сумі" %}</td>
                                                                                            <td class="alignright"> {{ price_total }} ₴ </td>
                                                                                        </tr>
                                                                                        
                                                                                    </tbody>
                                                                                </table>
                                                                            </td>
                                                                        </tr>
                                                                        <tr>
                                                                            <td class="d-flex justify-content-center">
                                                                                <form action="{% url 'app:get_ticket' session.id place.id price_total %}" id="formtest" method="get" >
                                                                                    {% csrf_token %}
                                                                                    <div class="input-group">
                                                                                        <input type="email" name="email_input" class= "input-email" id="formGroupExampleInput" placeholder="E-mail" required>
                                                                                        <div class="input-group-append">
                                                                                            <button class="btn btn-success" type="submit">{% trans 'Забронювати' %}</button>
                                                                                            
                                                                                        </div>
                                                                                    </div>
                                                                                </form>
                                                                                
                                                                            </td>
                                                                        </tr>
                                                                        
                                                                        <tr>
                                                                            <td class="">
                                                                                <!-- <div id="checkout"></div> -->


                                                                                <button class="btn btn-success" onclick="location.href=createOrder('{{ price_total }}')">{% trans 'Забронювати' %} {{ price_total }} UAH</button>




                                                                                <div id="liqpay_checkout">
                                                                                

                                                                                    <form method="POST" accept-charset="utf-8" action="https://www.liqpay.ua/api/3/checkout">
                                                                                        <input type="hidden" name="data" value="eyJ2ZXJzaW9uIjozLCJhY3Rpb24iOiJwYXkiLCJwdWJsaWNfa2V5IjoiaTcxMTUzNzY2NjAwIiwiYW1vdW50IjoiNSIsImN1cnJlbmN5IjoiVUFIIiwiZGVzY3JpcHRpb24iOiLQnNC+0Lkg0YLQvtCy0LDRgCIsInR5cGUiOiJidXkiLCJsYW5ndWFnZSI6InJ1In0=" />
                                                                                        <input type="hidden" name="signature" value="T4rPYFS4pHt3Om2L1q1aulWJdNs=" />
                                                                                        <button style="border: none !important; display:inline-block !important;text-align: center !important;padding: 7px 20px !important;
                                                                                            color: #fff !important; font-size:16px !important; font-weight: 600 !important; font-family:OpenSans, sans-serif; cursor: pointer !important; border-radius: 2px !important;
                                                                                            background: rgb(122,183,43) !important;"onmouseover="this.style.opacity='0.5';" onmouseout="this.style.opacity='1';">
                                                                                            <img src="https://static.liqpay.ua/buttons/logo-small.png" name="btn_text"
                                                                                                style="margin-right: 7px !important; vertical-align: middle !important;"/>
                                                                                            <span style="vertical-align: middle !important">Оплатить 5 UAH</span>
                                                                                        </button>
                                                                                    </form>

                                                                                    
                                                                                </div>
                                                                                    
                                                                            </td>
                                                                        </tr>
                                                                    </tbody>
                                                                </table>
                                                            </td>
                                                        </tr>
                                                        
                                                    </tbody>
                                                </table>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                                
                            </div>
                        </td>
                        <td></td>
                    </tr>
                </tbody>
            </table>

            
        
            
          
    
{% endblock  %}

{% block js %}{% get_current_language as LANGUAGE_CODE %}
    <script src="https://api.fondy.eu/static_common/v1/checkout/ipsp.js"></script>
    <!-- <script> // мой создайный лч кошелек
        var button = $ipsp.get('button');
        button.setMerchantId(1449720);
        button.setAmount(`{{ price_total }}`, 'UAH', true);
        button.addParam("lang","{{LANGUAGE_CODE}}");
        button.setResponseUrl('https://cinemaxpro.herokuapp.com/');
        button.setHost('api.fondy.eu');
    </script> -->
    <script> // тестовый кошелек card - 4444555566661111 use - 10/22 cvv - 324
        function createOrder(amount) {
            var button = $ipsp.get('button');
            button.setMerchantId(1449720);
            button.addParam("lang","{{LANGUAGE_CODE}}");
            button.setAmount(amount, 'UAH', true);
            
            button.setResponseUrl('https://cinemaxpro.herokuapp.com/');
            button.setHost('api.fondy.eu'); 
           
            
            return button.getUrl(); 
        }
        
        // var button = $ipsp.get('button');
        
        // button.setMerchantId(1449720);
        // button.setAmount(`{{ price_total }}`, 'UAH', true);
        // button.addParam("lang","{{LANGUAGE_CODE}}");
        // button.setResponseUrl('http://127.0.0.1:8000/'); 
        //button.setResponseUrl('https://cinemaxpro.herokuapp.com/');
        // button.setHost('api.fondy.eu');
        
        
   
    </script> 
   
    {% comment %}
    <!-- <script src="//api.fondy.eu/static_common/v1/checkout/ipsp.js"></script>
    <script>
        var button = $ipsp.get("button");
        button.setHost("api.fondy.eu");
        button.addParam("order_desc","cinemaxpay");
        button.addParam("lang","uk");
        button.setProtocol("https");
        button.setMerchantId(1449632);
        button.setAmount("{{ price_total }}","UAH",true);
        button.setResponseUrl("{response_url}");
        button.addParam("order_desc","квитки на сеанс");
        var url = button.getUrl();
        $ipsp("checkout").config({
            "wrapper": "#checkout",
                "styles": {
                    "body": {
                        "overflow": "hidden"
                    }
                }
        }).scope(function () {
            this.width("100%");
            this.height(480);
            this.action("resize", function (data) {
                this.setCheckoutHeight(data.height);
            })
            this.loadUrl(url);
        });
        </script> -->{% endcomment %}

        <!-- <script> попробовать залить на хостинг
            window.LiqPayCheckoutCallback = function() {
              LiqPayCheckout.init({
                data:"eyJ2ZXJzaW9uIjozLCJhY3Rpb24iOiJwYXkiLCJwdWJsaWNfa2V5IjoiaTcxMTUzNzY2NjAwIiwiYW1vdW50IjoiNSIsImN1cnJlbmN5IjoiVUFIIiwiZGVzY3JpcHRpb24iOiLQnNC+0Lkg0YLQvtCy0LDRgCIsInR5cGUiOiJidXkiLCJsYW5ndWFnZSI6InJ1In0=",
                signature: "T4rPYFS4pHt3Om2L1q1aulWJdNs",
                embedTo: "#liqpay_checkout",
                mode: "embed" // embed || popup,
                 }).on("liqpay.callback", function(data){
                      console.log(data.status);
                      console.log(data);
                      }).on("liqpay.ready", function(data){
                          // ready
                      }).on("liqpay.close", function(data){
                          // close
                  });
            };
          </script>
          <script src="//static.liqpay.ua/libjs/checkout.js" async></script> -->

          <!-- <script>
            liqpay = LiqPay('sandbox_i23530229261', private_key)
            html = liqpay.cnb_form({
                'action': 'pay',
                'amount': '1',
                'currency': 'USD',
                'description': 'description text',
                'order_id': 'order_id_1',
                'version': '3'
            })
        </script> -->
{% endblock %}
